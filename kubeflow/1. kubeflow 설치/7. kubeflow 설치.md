---
style: |
  img {
    display: block;
    float: none;
    margin-left: auto;
    margin-right: auto;
  }
marp: true
paginate: true
---
# 설치 전

---
### 단계1: manifests
```shell
git clone https://github.com/kubeflow/manifests.git 
```
![alt text](image-55.png)

---
# 설치 

---
## 전체 설치 방법 
- 최소 사양이상인 경우만 가능 
  - 기본메모리: 8192MB
  - 프로세서: 4
  - 저장소: 100GB(StorageClass: 60GB)
```shell
cd manifests 
while ! kustomize build example | kubectl apply -f -; do echo "Retrying to apply resources"; sleep 10; done
```
![alt text](image-56.png)

---
## [부분설치 방법](https://mlops-for-all.github.io/docs/setup-components/install-components-kf)

---
### 단계1: Cert-manager
```shell
cd manifests 
kustomize build common/cert-manager/cert-manager/base | kubectl apply -f -
```
![alt text](image-64.png)

---
- pod 가 모두 Running 이 될 때까지 기다립니다.
```shell
kubectl get pod -n cert-manager
```
![alt text](image-65.png)

---
- kubeflow-issuer
```shell
kustomize build common/cert-manager/kubeflow-issuer/base | kubectl apply -f -
```
![alt text](image-66.png)

---
### 단계2: Istio
```shell
kustomize build common/istio-1-17/istio-crds/base | kubectl apply -f -
```
![alt text](image-67.png)

---
- istio namespace 를 설치
```shell
kustomize build common/istio-1-17/istio-namespace/base | kubectl apply -f -
```
![alt text](image-68.png)

---
- istio 를 설치
```shell
kustomize build common/istio-1-17/istio-install/base | kubectl apply -f -
```
![alt text](image-69.png)

---
- pod 가 모두 Running 이 될 때까지 기다립니다.
```shell
kubectl get po -n istio-system
```
![alt text](image-70.png)

---
### 단계2: Dex
```shell
kustomize build common/dex/overlays/istio | kubectl apply -f -
```
![alt text](image-71.png)

---
- pod 가 모두 Running 이 될 때까지 기다립니다.
```shell
kubectl get po -n auth
```
![alt text](image-72.png)




---
# 설치 이후 

---
### 단계1: services 확인
```shell
kubectl get services --namespace istio-system
```
![alt text](image-57.png)

---
### 단계2: pods 확인 
- 전부 Running으로 올라오는데는 시간이 걸린다. 
```shell
kubectl get pod -A | egrep 'NAME|^auth|^cert-manager|^istio-system|^knative-|^kubeflow'
```
![alt text](image-44.png)

---
### 단계3: ClusterIP -> NodePort
- 웹 접근을 위해서는 현재 ClusterIP로 설정되어 있는 서비스를 NodePort로 변경 
```shell
kubectl edit service istio-ingressgateway -n istio-system
```
![bg right w:450](image-58.png)

---
- 변경 내용 확인 
```shell
kubectl get services --namespace istio-system
```
![alt text](image-59.png)




